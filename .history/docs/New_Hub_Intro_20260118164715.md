这是为您整合好的完整 Markdown 文档。

我已将 **Jupyter AI 的进阶配置（自动启动脚本）** 和 **魔法命令 (`%%ai`) 的参数说明** 添加到了第一部分（AI 编程助手）的末尾。

您可以直接点击右上角复制全文：

```markdown
# 🚀 全新 JupyterHub (2025) 上线指南

> [!NOTE]
> **JupyterHub 环境已完成重大升级！** 🎉  
> 本次更新集成了 **AI 编程助手**、**IDE 级代码补全**、**可视化 Git** 以及 **硬件监控** 等全家桶插件。  
> 旨在为您提供更流畅、更现代化的科研开发体验。

## 🌟 1. AI 编程助手 (Jupyter AI)

我们引入了官方的 **Jupyter AI** (`jupyter-ai`)。您可以在左侧边栏找到 "Jupyternaut" (🚀) 图标。

### 💬 智能对话 (Chat)
遇到不懂的代码或数学原理？直接在侧边栏提问，支持上下文关联。您可以选中代码块，然后问它：“这段代码是做什么的？”

<div align="center">
  <video src="./images/New_Hub/AI-chat.mp4" controls autoplay loop muted style="max-width: 30%; box-shadow: 0 4px 8px rgba(0,0,0,0.1); border-radius: 8px;"></video>
</div>

### 🪄 代码生成 (Generate)
通过自然语言指令生成代码片段，告别繁琐的样板代码。例如输入：“写一个绘制引力透镜光变的函数”。

<video src="./images/New_Hub/AI-generator.mp4" controls autoplay loop muted style="max-width: 100%; box-shadow: 0 4px 8px rgba(0,0,0,0.1); border-radius: 8px;"></video>

### 🧠 智能补全 (Complement/Inline)
它能理解您的代码意图，提供行内代码补全和建议。灰色提示出现时，按 `Tab` 键即可采纳。

<video src="./images/New_Hub/AI-complement.mp4" controls autoplay loop muted style="max-width: 100%; box-shadow: 0 4px 8px rgba(0,0,0,0.1); border-radius: 8px;"></video>

### 🔮 进阶：魔法命令与自动配置

除了图形界面，您还可以使用强大的 **Magic Commands** 直接在单元格中交互。

#### 1. 魔法命令 (Magic Commands)
使用 `%%ai` 命令可以在 Notebook 单元格中直接调用模型。
* **基础用法**: `%%ai deepseek-chat` 后面跟提示词。
* **常用参数**:
    * `--format` 或 `-f`: 指定输出格式。
        * `-f code`: 生成可直接运行的代码（自动创建下一个 Code Cell）。
        * `-f math`: 生成 LaTeX 数学公式。
        * `-f html`: 生成 HTML 代码并渲染。

**示例：**
```python
%%ai deepseek-chat -f code
请写一个使用 matplotlib 绘制正弦波的 Python 代码

```

#### 2. ⚡ 一键配置 DeepSeek (自动加载)

为了避免每次重启内核都需要重新输入 API Key 和加载扩展，您可以配置 **启动脚本**。
请在 **Terminal** 中运行以下命令，系统将自动创建配置文件：
*(注意：请将命令中的 `你的API_KEY` 替换为您申请的真实 Key)*

```bash
# 1. 确保启动脚本目录存在
mkdir -p ~/.ipython/profile_default/startup/

# 2. 创建初始化脚本：自动配置 DeepSeek 并加载魔法命令
cat <<EOF > ~/.ipython/profile_default/startup/01-jupyter-ai-init.py
import os

# 配置环境变量（配置 DeepSeek API）
# !!! 请务必将下方 "你的API_KEY" 替换为真实的 Key !!!
os.environ["OPENAI_API_KEY"] = "你的API_KEY"
os.environ["OPENAI_API_BASE"] = "[https://api.deepseek.com/v1](https://api.deepseek.com/v1)"

try:
    # 自动加载魔法命令扩展
    ip = get_ipython()
    if ip:
        ip.run_line_magic('load_ext', 'jupyter_ai_magics')
        
        # 自动将 DeepSeek 设为 %%ai 的默认模型
        # 以后使用 %%ai 时无需再输入模型名称，直接写 %%ai 即可
        ip.run_line_magic('config', 'AiMagics.default_language_model = "openai-chat:deepseek-chat"')
        
    print("✅ Jupyter AI 自动初始化成功：魔法命令已加载，DeepSeek 已就绪")
except Exception as e:
    print(f"❌ Jupyter AI 初始化失败: {e}")
EOF

```

配置完成后，下次启动 Notebook 时，您只需直接输入 `%%ai` 即可使用 DeepSeek 模型！

---

## ⚡ 2. 代码开发效率工具

### 🎨 一键代码美化 (Code Formatter)

治愈强迫症！工具栏新增了 **"Format"** 按钮（或右键菜单）。
底层集成 **Black** 和 **Isort**，自动调整缩进、空格，并自动整理 `import` 顺序。

<video src="./images/New_Hub/Code%20Formatter.mp4" controls autoplay loop muted style="max-width: 100%; box-shadow: 0 4px 8px rgba(0,0,0,0.1); border-radius: 8px;"></video>

### 🔍 智能诊断 (LSP)

现在的 JupyterLab 拥有了类似 VS Code 的智能感知能力：

* **自动补全**: 输入代码时自动提示函数、变量和参数。
* **跳转定义**: 点击函数名，按住 `Ctrl`，可直接跳转到定义处。

> [!TIP]
> **关于红色波浪线 (Linting)**：
> 我们已经优化了默认配置，**屏蔽了** Notebook 中常见的干扰性警告（如 `E402` 模块导入位置、`E501` 行过长）。
> 如果您仍觉得提示过多，可点击底部状态栏的 `LSP` 图标，在 Diagnostics 中将其关闭。

---

## 📦 3. 可视化版本控制 (Git GUI)

不再需要死记硬背 Git 命令行！左侧栏新增了 **Git 面板**。

* **可视化 Diff**: 清晰对比代码修改前后的差异。
* **一键 Commit**:
1. 点击文件旁的 `+` 号（Stage 暂存）。
2. 输入 Message。
3. 点击蓝色 **Commit** 按钮。


* **History**: 可视化查看历史提交记录与分支图。

<video src="./images/New_Hub/git-gui.mp4" controls autoplay loop muted style="max-width: 100%; box-shadow: 0 4px 8px rgba(0,0,0,0.1); border-radius: 8px;"></video>

---

## 🛠️ 4. 强大的辅助插件

### 📌 侧边栏输出 (Sidecar)

在运行画图代码或长文本输出时，不再需要上下翻页对照。使用 `Sidecar` 将输出“钉”在右侧侧边栏，实现分屏预览：

```python
from sidecar import Sidecar
from IPython.display import display
import matplotlib.pyplot as plt

# 您的图表或数据将显示在右侧分屏中，互不干扰
with Sidecar(title='Result View', anchor='split-right'):
    display(fig)

```

<video src="./images/New_Hub/Sidecar.mp4" controls autoplay loop muted style="max-width: 100%; box-shadow: 0 4px 8px rgba(0,0,0,0.1); border-radius: 8px;"></video>

### 🗜️ 文件夹打包下载 (Archive)

在左侧文件浏览器中，**右键点击任意文件夹 -> "Download as .zip"**。
系统会自动将文件夹打包并下载到本地，无需再使用 `tar` 命令手动打包。

<video src="./images/New_Hub/archive-download.mp4" controls autoplay loop muted style="max-width: 100%; box-shadow: 0 4px 8px rgba(0,0,0,0.1); border-radius: 8px;"></video>

### 🕵️ 变量查看器 (Variable Inspector)

**右键点击** Notebook 空白处 -> `Open Variable Inspector`。
像 MATLAB/RStudio 一样，以表格形式查看当前内存中所有变量的值、类型和矩阵形状。

---

## ⚙️ 个性化设置 (Settings)

我们已经预设了最佳实践配置，但如果您想根据个人喜好调整（例如彻底关闭代码检查）：

1. 点击顶部菜单 **Settings** -> **Settings Editor**。
2. 找到对应插件（如 **Language Server**）。
3. 在右侧 **User Preferences** 中修改。

> [!WARNING]
> **如何彻底关闭语法检查？** > 如果您不需要代码查错功能（红波浪线），可以在 User Preferences 中填入以下配置：
> ```json
> {
>   "client": {
>     "diagnostics": {
>       "enabled": false
>     }
>   }
> }
> 
> ```
> 
> 

```

```